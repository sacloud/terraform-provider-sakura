---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "sakura_enhanced_lb Resource - sakura"
subcategory: "Networking"
description: |-
  Manages an Enhanced Load Balancer(proxylb in v2).
---

# sakura_enhanced_lb (Resource)

Manages an Enhanced Load Balancer(proxylb in v2).

## Example Usage

```terraform
resource "sakura_enhanced_lb" "foobar" {
  name           = "foobar"
  plan           = 100
  vip_failover   = true
  gzip           = true
  timeout        = 10
  region         = "is1"
#  sticky_session = true
#  proxy_protocol = true

  health_check = {
    protocol    = "http"
    delay_loop  = 10
    host_header = "example.com"
    path        = "/"
  }

  sorry_server = {
    ip_address = "192.0.2.1"
    port       = 80
  }

  syslog = {
    server = "192.0.2.1"
    port   = 514
  }

  bind_port = [{
    proxy_mode = "http"
    port       = 80
    response_header = [{
      header = "Cache-Control"
      value  = "public, max-age=10"
    }]
  }]

  server = [{
    ip_address = sakura_server.foobar.ip_address
    port       = 80
    group      = "group1"
  }]

  rule = [{
    action     = "forward"
    host       = "www.example.com"
    source_ips = "192.2.0.1,192.12.0.2"
    path       = "/"
    group      = "group1"
  },
  {
    action               = "redirect"
    host                 = "www2.example.com"
    path                 = "/"
    group                = "group1"
    redirect_location    = "https://redirect.example.com"
    redirect_status_code = "301"
  },
  {
    action               = "fixed"
    host                 = "www3.example.com"
    path                 = "/"
    group                = "group1"
    fixed_status_code    = "200"
    fixed_content_type   = "text/plain"
    fixed_message_body   = "body"
  }]

  description = "description"
  tags        = ["tag1", "tag2"]
}

resource "sakura_server" "foobar" {
  name = "foobar"
  network_interface = [{
    upstream = "shared"
  }]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `bind_port` (Attributes List) (see [below for nested schema](#nestedatt--bind_port))
- `health_check` (Attributes) (see [below for nested schema](#nestedatt--health_check))
- `name` (String) The name of the Enhanced LB.

### Optional

- `backend_http_keep_alive` (String) Mode of http keep-alive with backend. This must be one of [`safe`/`aggressive`]
- `certificate` (Attributes) (see [below for nested schema](#nestedatt--certificate))
- `description` (String) The description of the Enhanced LB. The length of this value must be in the range [`1`-`512`]
- `gzip` (Boolean) The flag to enable gzip compression
- `icon_id` (String) The icon id to attach to the Enhanced LB
- `plan` (Number) The plan name of the Enhanced LB. This must be one of [`100`/`500`/`1000`/`5000`/`10000`/`50000`/`100000`/`400000`]
- `proxy_protocol` (Boolean) The flag to enable proxy protocol v2
- `region` (String) The name of region that the Enhanced LB is in. This must be one of [`tk1`/`is1`/`anycast`]
- `rule` (Attributes List) (see [below for nested schema](#nestedatt--rule))
- `server` (Attributes List) (see [below for nested schema](#nestedatt--server))
- `sorry_server` (Attributes) (see [below for nested schema](#nestedatt--sorry_server))
- `sticky_session` (Boolean) The flag to enable sticky session
- `syslog` (Attributes) (see [below for nested schema](#nestedatt--syslog))
- `tags` (Set of String) The tags of the Enhanced LB.
- `timeout` (Number) The timeout duration in seconds
- `timeouts` (Attributes) (see [below for nested schema](#nestedatt--timeouts))
- `vip_failover` (Boolean) The flag to enable VIP fail-over

### Read-Only

- `fqdn` (String) The FQDN for accessing to the Enhanced LB. This is typically used as value of CNAME record
- `id` (String) The ID of the Enhanced LB.
- `letsencrypt` (Attributes) (see [below for nested schema](#nestedatt--letsencrypt))
- `proxy_networks` (List of String) A list of CIDR block used by the Enhanced LB to access the server
- `vip` (String) The virtual IP address assigned to the Enhanced LB

<a id="nestedatt--bind_port"></a>
### Nested Schema for `bind_port`

Required:

- `port` (Number) The number of listening port
- `proxy_mode` (String) The proxy mode. This must be one of [`http`/`https`/`tcp`]

Optional:

- `redirect_to_https` (Boolean) The flag to enable redirection from http to https. This flag is used only when `proxy_mode` is `http`
- `response_header` (Attributes List) (see [below for nested schema](#nestedatt--bind_port--response_header))
- `ssl_policy` (String) The ssl policy. This must be one of [`TLS-1-2-2019-04`/`TLS-1-2-2021-06`/`TLS-1-3-2021-06`]
- `support_http2` (Boolean) The flag to enable HTTP/2. This flag is used only when `proxy_mode` is `https`

<a id="nestedatt--bind_port--response_header"></a>
### Nested Schema for `bind_port.response_header`

Required:

- `header` (String) The field name of HTTP header added to response by the Enhanced LB
- `value` (String) The field value of HTTP header added to response by the Enhanced LB



<a id="nestedatt--health_check"></a>
### Nested Schema for `health_check`

Required:

- `protocol` (String) The protocol used for health checks. This must be one of [`http`/`tcp`]

Optional:

- `delay_loop` (Number) The interval in seconds between checks. This must be in the range [`10`-`60`]
- `host_header` (String) The value of host header send when checking by HTTP
- `path` (String) The path used when checking by HTTP


<a id="nestedatt--certificate"></a>
### Nested Schema for `certificate`

Required:

- `intermediate_cert` (String) The intermediate certificate for a server
- `private_key` (String, Sensitive) The private key for a server
- `server_cert` (String) The certificate for a server

Optional:

- `additional_certificate` (Attributes List) (see [below for nested schema](#nestedatt--certificate--additional_certificate))

Read-Only:

- `common_name` (String) The common name of the certificate
- `subject_alt_names` (String) The subject alternative names of the certificate

<a id="nestedatt--certificate--additional_certificate"></a>
### Nested Schema for `certificate.additional_certificate`

Required:

- `private_key` (String, Sensitive) The private key for a server
- `server_cert` (String) The certificate for a server

Optional:

- `intermediate_cert` (String) The intermediate certificate for a server



<a id="nestedatt--rule"></a>
### Nested Schema for `rule`

Optional:

- `action` (String) The type of action to be performed when requests matches the rule. This must be one of [`forward`/`redirect`/`fixed`]
- `fixed_content_type` (String) Content-Type header value for fixed response sent when requests matches the rule. This must be one of [`text/plain`/`text/html`/`application/javascript`/`application/json`]
- `fixed_message_body` (String) Content body for fixed response sent when requests matches the rule
- `fixed_status_code` (String) HTTP status code for fixed response sent when requests matches the rule. This must be one of [`200`/`403`/`503`]
- `group` (String) The name of load balancing group. When enhanced LB received request which matched to `host` and `path`, enhanced LB forwards the request to servers that having same group name. The length of this value must be in the range [`1`-`10`]
- `host` (String) The value of HTTP host header that is used as condition of rule-based balancing
- `path` (String) The request path that is used as condition of rule-based balancing
- `redirect_location` (String) The URL to redirect to when the request matches the rule. see https://manual.sakura.ad.jp/cloud/appliance/enhanced-lb/#enhanced-lb-rule for details
- `redirect_status_code` (String) HTTP status code for redirects sent when requests matches the rule. This must be one of [`301`/`302`]
- `request_header_name` (String) The header name that the client will send when making a request
- `request_header_value` (String) The condition for the value of the request header specified by the request header name
- `request_header_value_ignore_case` (Boolean) Boolean value representing whether the request header value ignores case
- `request_header_value_not_match` (Boolean) Boolean value representing whether to apply the rules when the request header value conditions are met or when the conditions do not match
- `source_ips` (String) IP address or CIDR block to which the rule will be applied. Multiple values can be specified by separating them with a space or comma


<a id="nestedatt--server"></a>
### Nested Schema for `server`

Required:

- `ip_address` (String) The IP address of the destination server
- `port` (Number) The port number of the destination server. This must be in the range [`1`-`65535`]

Optional:

- `enabled` (Boolean) The flag to enable as destination of load balancing
- `group` (String) The name of load balancing group. This is used when using rule-based load balancing. The length of this value must be in the range [`1`-`10`]


<a id="nestedatt--sorry_server"></a>
### Nested Schema for `sorry_server`

Required:

- `ip_address` (String) The IP address of the SorryServer. This will be used when all servers are down
- `port` (Number) The port number of the SorryServer. This will be used when all servers are down


<a id="nestedatt--syslog"></a>
### Nested Schema for `syslog`

Required:

- `port` (Number) The number of syslog port
- `server` (String) The address of syslog server


<a id="nestedatt--timeouts"></a>
### Nested Schema for `timeouts`

Optional:

- `create` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).
- `delete` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours). Setting a timeout for a Delete operation is only applicable if changes are saved into state before the destroy operation occurs.
- `update` (String) A string that can be [parsed as a duration](https://pkg.go.dev/time#ParseDuration) consisting of numbers and unit suffixes, such as "30s" or "2h45m". Valid time units are "s" (seconds), "m" (minutes), "h" (hours).


<a id="nestedatt--letsencrypt"></a>
### Nested Schema for `letsencrypt`

Read-Only:

- `common_name` (String) The common name of the certificate
- `enabled` (Boolean) The flag to accept the current Let's Encrypt terms of service(see: https://letsencrypt.org/repository/). This must be set `true` explicitly
- `subject_alt_names` (Set of String) The subject alternative names of the certificate
